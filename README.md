#### NAME : SUBRAMANIYA PILLAI B
#### SUPERSET ID : 5371539
#### SAVEETHA ENGINEERING COLLEGE
# <p align="center">COURIER MANAGEMENT SYSTEM</p>

## <p align="center"> TASK 1</p>
### Objective:
- Design a SQL schema for a Courier Management System.
- Create tables for Customers, Couriers, Orders, and Parcels.
- Define relationships between these tables using appropriate foreign keys.
- Insert sample data into these tables.

### Tables Created:
- **User**
- **Courier**
- **CourierServices**
- **Employee**
- **Location**
- **Payment**

---

#### tables created in the data base
![image](https://github.com/user-attachments/assets/56ebf584-6618-41f6-b47b-7358fe980316)

#### 1. courier table

![image](https://github.com/user-attachments/assets/6abc4d38-0a03-4ade-a64a-489250d26706)


#### 3. Employee table

   
![image](https://github.com/user-attachments/assets/81e89dac-84b1-4935-9721-5f00366bd869)


#### 4. User table
   
![image](https://github.com/user-attachments/assets/a1ac0ecc-2276-4fee-80e2-f3f113e7f2ed)


#### 5. Services table
![image](https://github.com/user-attachments/assets/0665f0b1-a209-4137-8973-bfa05d0e5b7c)

#### 6. Payment table

![image](https://github.com/user-attachments/assets/49c0e37a-a936-4b0b-bc3b-126dc9ec2810)

#### 7. Location table

![image](https://github.com/user-attachments/assets/778bd9ac-8fc9-4f95-916c-cdc38a59f7aa)

#### relationships between these tables using appropriate foreign keys

![image](https://github.com/user-attachments/assets/c5d73266-43e6-4315-86ca-a292ec9ce79f)



## <p align="center"> TASK 2</p>
### Objective:
- Perform SQL queries on the created database.

### Queries Performed:
#### 01. List all customers.
   
   ![01](https://github.com/user-attachments/assets/b0ce41b3-c35a-4f10-9837-79ed11ac0e72)
#### 02. List all orders for a specific customer.

   ![image](https://github.com/user-attachments/assets/b6ee5c3a-6ec1-408f-b782-d42e9411658b)

#### 03. List all couriers.

![image](https://github.com/user-attachments/assets/8aaf17b5-4613-4e5f-bde6-4f7012d212d3)

#### 04. List all packages for a specific order.

![image](https://github.com/user-attachments/assets/429ace3f-7523-42df-aca1-056a6d2288c2)

#### 05. List all deliveries for a specific courier: 

![image](https://github.com/user-attachments/assets/70c0feb8-fb27-435b-a3f7-4adab24bae8f)

#### 06. List all undelivered packages.

   ![image](https://github.com/user-attachments/assets/f13d379b-45ca-4c4c-8ca6-90d85783022a)

#### 07. List all packages scheduled for delivery today.

![image](https://github.com/user-attachments/assets/1819300a-2ee7-42f9-abdc-d309add5ce8d)

#### 08. List all packages with a specific status.

![image](https://github.com/user-attachments/assets/295e1516-551d-467c-bbba-50db88b29a37)

#### 09. Calculate the total number of packages for each courier.

![image](https://github.com/user-attachments/assets/feb27723-7bcb-4214-880f-6afe0c6dfbaf)

#### 10. Find the average delivery time for each courier.

![image](https://github.com/user-attachments/assets/bf0dbd7a-8530-414d-9f65-b3c981c9ab9b)

#### 11. List all packages with a specific weight range.
![image](https://github.com/user-attachments/assets/2be1366b-9207-4cfc-9d93-481614aa82f5)


#### 12. Retrieve employees whose names contain 'John'.
![image](https://github.com/user-attachments/assets/da3f34a1-cf0e-442e-91bf-002ba518257c)

#### 13. Retrieve all courier records with payments greater than $50.

![image](https://github.com/user-attachments/assets/7c1374d1-0309-4480-88bd-48b2088fb32a)


## <p align="center"> TASK 3</p>
### GroupBy, Aggregate Functions, Having, Order By, where
14. Find the total number of couriers handled by each employee.
    ![image](https://github.com/user-attachments/assets/2555c5a8-871b-4d49-a62a-7afa3a8c013c)

15. Calculate the total revenue generated by each location
    ![image](https://github.com/user-attachments/assets/f36e1d13-d316-458e-8956-5fd4f67915e1)

16. Find the total number of couriers delivered to each location.

    ![image](https://github.com/user-attachments/assets/0d8c843d-d497-4418-9746-9c854a381138)

17. Find the courier with the highest average delivery time:
    
   ![image](https://github.com/user-attachments/assets/974bf7d9-619d-413f-9297-2f50a6c13c96)

    
18. Find Locations with Total Payments Less Than a Certain Amount

![image](https://github.com/user-attachments/assets/e839c8dd-b3d8-4057-b629-aeb6e136347e)

19. Calculate Total Payments per Location

![image](https://github.com/user-attachments/assets/ef601391-1f56-4acf-a4da-90e62f97f5db)

20. Retrieve couriers who have received payments totaling more than $1000 in a specific location
(LocationID = X):

![image](https://github.com/user-attachments/assets/cb71b1ce-4a0e-4c3f-953b-db9f79594063)


21. Retrieve couriers who have received payments totaling more than $1000 after a certain date
(PaymentDate > 'YYYY-MM-DD'):

![image](https://github.com/user-attachments/assets/3b597a78-11e7-46be-9a7e-27bc345d8473)





## <p align="center"> TASK 4</p>

23. Retrieve Payments with Courier Information 

![image](https://github.com/user-attachments/assets/9b06c060-92a3-4946-bcb3-a5edc2b3d365)

24. Retrieve Payments with Location Information

![image](https://github.com/user-attachments/assets/a60566fd-60ef-42f2-a73f-0359906afb03)

25. Retrieve Payments with Courier and Location Information

![image](https://github.com/user-attachments/assets/819123fd-43e7-4d09-9611-46cec60a821f)

26.  List all payments with courier details

   same as 23rd question

27. Total payments received for each courier

![image](https://github.com/user-attachments/assets/a6a0f96d-81bf-4002-b402-5ae054414bb5)

28. List payments made on a specific date

![image](https://github.com/user-attachments/assets/33c18db9-93f8-4f73-8497-eb25630752f0)

29. Get Courier Information for Each Payment

![image](https://github.com/user-attachments/assets/4928dec6-9d80-44d1-b712-e384d516ab97)

30. Get Payment Details with Location

![image](https://github.com/user-attachments/assets/35159888-a18b-4331-9076-c07af659a9f6)

31. Calculating Total Payments for Each Courier

![image](https://github.com/user-attachments/assets/a6a0f96d-81bf-4002-b402-5ae054414bb5)

32. List Payments Within a Date Range

![image](https://github.com/user-attachments/assets/3cb224ec-a483-4bd6-9b10-b4f34e771759)

33. Retrieve a list of all users and their corresponding courier records, including cases where there are
no matches on either side 

![image](https://github.com/user-attachments/assets/2112c2b7-8f41-4dab-ac47-88554ce55476)

34. Retrieve a list of all couriers and their corresponding services, including cases where there are no
matches on either side 

![image](https://github.com/user-attachments/assets/b187cb06-7ea8-4eb5-9246-a1f9caa68e09)

35. . Retrieve a list of all employees and their corresponding payments, including cases where there are
no matches on either side

![image](https://github.com/user-attachments/assets/803df6d3-4b2c-4a58-a3b5-1640ef5a6c83)

36. List all users and all courier services, showing all possible combinations.

![image](https://github.com/user-attachments/assets/ba2fb885-b2ff-4447-88f1-6d568549e25b)

37. . List all employees and all locations, showing all possible combinations:

![image](https://github.com/user-attachments/assets/a292c7ad-daf8-4e25-9da7-066166794261)

38. Retrieve a list of couriers and their corresponding sender information (if available)

![image](https://github.com/user-attachments/assets/d3faa57d-9cb2-4f84-8c9f-d4a09af043d1)

39. Retrieve a list of couriers and their corresponding receiver information (if available):

![image](https://github.com/user-attachments/assets/3ae8c29c-49a1-4aba-ad1a-c070e304fb08)

40. Retrieve a list of couriers along with the courier service details (if available):

![image](https://github.com/user-attachments/assets/f69c659e-39bf-43f0-8f1d-4bdc9e9ba669)

41. Retrieve a list of employees and the number of couriers assigned to each employee: 

![image](https://github.com/user-attachments/assets/3ca1f665-c4f0-4dbc-9f48-2855039749f9)

42. Retrieve a list of locations and the total payment amount received at each location:

![image](https://github.com/user-attachments/assets/2c346c9d-8ff3-484d-b05f-a4fb26f356fd)

43. Retrieve all couriers sent by the same sender (based on SenderName). 

![image](https://github.com/user-attachments/assets/72773aa7-a88a-4e9d-9634-d3d8fe4e12bb)

44.  List all employees who share the same role. 

![image](https://github.com/user-attachments/assets/29ee476d-5f79-4329-8e76-fa26656ec0ff)

45.  Retrieve all payments made for couriers sent from the same location.

![image](https://github.com/user-attachments/assets/d65fc365-f3be-4192-8cae-26808aa4d2c2)

46. Retrieve all couriers sent from the same location (based on SenderAddress). 

![image](https://github.com/user-attachments/assets/cefffc50-2060-4605-91d1-a6d788f80876)

47. List employees and the number of couriers they have delivered:

![image](https://github.com/user-attachments/assets/27b94493-6d2b-4138-8bc6-072d3e18d573)

48. Find couriers that were paid an amount greater than the cost of their respective courier services

![image](https://github.com/user-attachments/assets/b372822b-eeb5-41f3-a280-f4779225b25e)


## <p align="center"> TASK 5</p>

### Scope: Inner Queries, Non Equi Joins, Equi joins,Exist,Any,All

49. Find couriers that have a weight greater than the average weight of all couriers

![image](https://github.com/user-attachments/assets/28d286c5-d2e8-4183-9cd6-539456c4711b)

50. Find the names of all employees who have a salary greater than the average salary:

![image](https://github.com/user-attachments/assets/9e19974b-49bb-4a9f-975b-c81c715a5719)

51. Find the total cost of all courier services where the cost is less than the maximum cost

![image](https://github.com/user-attachments/assets/686a8c43-dc2c-42fe-a8b6-99f1315eb0a6)

52. Find all couriers that have been paid for

![image](https://github.com/user-attachments/assets/020dd9cf-4887-4196-a0ed-ca2ccde85fa8)

53. Find the locations where the maximum payment amount was made

![image](https://github.com/user-attachments/assets/f21aa0cf-0f7d-4be0-a6c2-3b33b462059d)


54. Find all couriers whose weight is greater than the weight of all couriers sent by a specific sender
(e.g., 'SenderName'):

![image](https://github.com/user-attachments/assets/eaf92f95-aa63-4e9d-9657-156ceec85795)

## <p align="center"> CODING</p>

## <p align="center"> TASK 1</p>

### Connecting the database 

#### Created a python file named as db_connection for connecting database

```
def get_db_connection():
    import mysql.connector

    try:
        connection = mysql.connector.connect(
            host="localhost",
            user="root",
            password="Vineeth1246@",
            database="courier_db"
        )
        return connection
    except mysql.connector.Error as err:
        print(f"Database Connection Error: {err}")
        return None

```


<p align="center">
  <img src="https://github.com/user-attachments/assets/32359cd0-6791-429d-90b7-6f403f5dfdf7" width="45%" />
</p>

### Control Flow Statements 

1. Write a program that checks whether a given order is delivered or not based on its status (e.g., "Processing," "Delivered," "Cancelled"). Use if-else statements for this.
```
def get_db_connection():
    import mysql.connector

    try:
        connection = mysql.connector.connect(
            host="localhost",
            user="root",
            password="Vineeth1246@",
            database="courier_db"
        )
        return connection
    except mysql.connector.Error as err:
        print(f"Database Connection Error: {err}")
        return None

```
### <p align="center"> output / database </p>

<p align="center">
  <img src="https://github.com/user-attachments/assets/97886216-6c97-4a82-afa5-db53b4d0fc50" width="45%" />
  <img src="https://github.com/user-attachments/assets/ffdaf511-907d-4a50-a5ce-fc1ec545da70" width="45%" />
</p>

2.   Implement a switch-case statement to categorize parcels based on their weight into "Light," "Medium," or "Heavy."

```
from db_connection import get_db_connection

def categorize_parcel(weight):
    """Categorize parcel based on weight."""
    categories = {
        "Light": lambda w: w < 2,
        "Medium": lambda w: 2 <= w < 5,
        "Heavy": lambda w: w >= 5
    }

    for category, condition in categories.items():
        if condition(weight):
            return category
    return "Unknown"

def get_parcel_weight(courier_id):
    """Fetch weight from the database based on courier_id."""
    conn = get_db_connection()
    cursor = conn.cursor()

    query = "SELECT weight FROM courier WHERE courier_id = %s"
    cursor.execute(query, (courier_id,))
    result = cursor.fetchone()

    conn.close()

    if result:
        return result[0]  # Extract weight value from result tuple
    else:
        return None

# Example usage
courier_id = int(input("Enter Courier ID: "))
weight = get_parcel_weight(courier_id)

if weight is not None:
    category = categorize_parcel(weight)
    print(f"Parcel with Courier ID {courier_id} is categorized as: {category}")
else:
    print("Courier ID not found!")

```

### <p align="center"> output / database </p>


<p align="center">
  <img src="https://github.com/user-attachments/assets/78ca4418-00e7-4bd4-a325-1735cf123f12" width="45%" />
  <img src="https://github.com/user-attachments/assets/0e2a3a31-b67a-4806-af23-21c7d427d0a6" width="45%" />
</p>


3. Implement User Authentication 1. Create a login system for employees and customers using Java
control flow statements.


```
def get_db_connection():
    import mysql.connector

    try:
        connection = mysql.connector.connect(
            host="localhost",
            user="root",
            password="Vineeth1246@",
            database="courier_db"
        )
        return connection
    except mysql.connector.Error as err:
        print(f"Database Connection Error: {err}")
        return None

# Function to authenticate employee login
def employee_login(name, password):
    conn = get_db_connection()
    cursor = conn.cursor()

    query = "SELECT * FROM employee WHERE name = %s AND password = %s"
    cursor.execute(query, (name, password))
    result = cursor.fetchone()

    cursor.close()
    conn.close()

    if result:
        print(f"✅ Login successful! Welcome, {name}.")
    else:
        print("❌ Invalid credentials. Please try again.")

# Example usage
if __name__ == "__main__":
    emp_name = input("Enter your name: ")
    emp_password = input("Enter your password: ")
    employee_login(emp_name, emp_password)

```
### <p align="center"> logging in with valid credentials / invalid credentials </p>

<p align="center">
  <img src="https://github.com/user-attachments/assets/bc5f6f0c-ba4a-4cfc-8d5f-d1e5335a2e01" width="45%" />
  <img src="https://github.com/user-attachments/assets/fcacbb8b-a8da-49b2-a782-0a7eb2032853" width="45%" />
</p>

4. Implement Courier Assignment Logic 1. Develop a mechanism to assign couriers to shipments based
on predefined criteria (e.g., proximity, load capacity) using loops.

```
import mysql.connector

# Establish database connection
def get_db_connection():
    return mysql.connector.connect(
        host="localhost",
        user="root",
        password="Vineeth1246@",
        database="courier_db"
    )

# Function to assign a courier to a shipment
def assign_courier(shipment_id):
    conn = get_db_connection()
    cursor = conn.cursor()

    # Fetch shipment details (location and weight)
    cursor.execute("SELECT location_id, weight FROM shipment WHERE shipment_id = %s", (shipment_id,))
    shipment = cursor.fetchone()

    if not shipment:
        print("❌ Shipment not found.")
        return

    shipment_location, shipment_weight = shipment

    # Fetch a suitable courier (fixing query)
    query = """
        SELECT courier_id, weight 
        FROM courier 
        WHERE weight >= %s 
        ORDER BY weight ASC 
        LIMIT 1;
    """
    cursor.execute(query, (shipment_weight,))
    assigned_courier = cursor.fetchone()

    if assigned_courier:
        courier_id, courier_weight = assigned_courier
        print(f"✅ Assigned Courier: {courier_id} (Max Weight: {courier_weight})")

        # Update shipment with assigned courier
        cursor.execute("UPDATE shipment SET courier_id = %s WHERE shipment_id = %s", (courier_id, shipment_id))
        conn.commit()
    else:
        print("❌ No suitable courier available.")

    cursor.close()
    conn.close()

# Example usage
if __name__ == "__main__":
    shipment_id = int(input("Enter Shipment ID: "))
    assign_courier(shipment_id)
```
<p align="center">
  <img src="https://github.com/user-attachments/assets/b8a70c5f-b10a-4449-905a-a92913c376e8" width="45%" />
</p>

