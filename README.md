#### NAME : SUBRAMANIYA PILLAI B
#### SUPERSET ID : 5371539
#### SAVEETHA ENGINEERING COLLEGE
# <p align="center">COURIER MANAGEMENT SYSTEM</p>

## <p align="center"> TASK 1</p>
### Objective:
- Design a SQL schema for a Courier Management System.
- Create tables for Customers, Couriers, Orders, and Parcels.
- Define relationships between these tables using appropriate foreign keys.
- Insert sample data into these tables.

### Tables Created:
- **User**
- **Courier**
- **CourierServices**
- **Employee**
- **Location**
- **Payment**

---

#### tables created in the data base
![image](https://github.com/user-attachments/assets/56ebf584-6618-41f6-b47b-7358fe980316)

#### 1. courier table

![image](https://github.com/user-attachments/assets/6abc4d38-0a03-4ade-a64a-489250d26706)


#### 3. Employee table

   
![image](https://github.com/user-attachments/assets/81e89dac-84b1-4935-9721-5f00366bd869)


#### 4. User table
   
![image](https://github.com/user-attachments/assets/a1ac0ecc-2276-4fee-80e2-f3f113e7f2ed)


#### 5. Services table
![image](https://github.com/user-attachments/assets/0665f0b1-a209-4137-8973-bfa05d0e5b7c)

#### 6. Payment table

![image](https://github.com/user-attachments/assets/49c0e37a-a936-4b0b-bc3b-126dc9ec2810)

#### 7. Location table

![image](https://github.com/user-attachments/assets/778bd9ac-8fc9-4f95-916c-cdc38a59f7aa)

#### relationships between these tables using appropriate foreign keys

![image](https://github.com/user-attachments/assets/c5d73266-43e6-4315-86ca-a292ec9ce79f)



## <p align="center"> TASK 2</p>
### Objective:
- Perform SQL queries on the created database.

### Queries Performed:
#### 01. List all customers.
   
   ![01](https://github.com/user-attachments/assets/b0ce41b3-c35a-4f10-9837-79ed11ac0e72)
#### 02. List all orders for a specific customer.

   ![image](https://github.com/user-attachments/assets/b6ee5c3a-6ec1-408f-b782-d42e9411658b)

#### 03. List all couriers.

![image](https://github.com/user-attachments/assets/8aaf17b5-4613-4e5f-bde6-4f7012d212d3)

#### 04. List all packages for a specific order.

![image](https://github.com/user-attachments/assets/429ace3f-7523-42df-aca1-056a6d2288c2)

#### 05. List all deliveries for a specific courier: 

![image](https://github.com/user-attachments/assets/70c0feb8-fb27-435b-a3f7-4adab24bae8f)

#### 06. List all undelivered packages.

   ![image](https://github.com/user-attachments/assets/f13d379b-45ca-4c4c-8ca6-90d85783022a)

#### 07. List all packages scheduled for delivery today.

![image](https://github.com/user-attachments/assets/1819300a-2ee7-42f9-abdc-d309add5ce8d)

#### 08. List all packages with a specific status.

![image](https://github.com/user-attachments/assets/295e1516-551d-467c-bbba-50db88b29a37)

#### 09. Calculate the total number of packages for each courier.

![image](https://github.com/user-attachments/assets/feb27723-7bcb-4214-880f-6afe0c6dfbaf)

#### 10. Find the average delivery time for each courier.

![image](https://github.com/user-attachments/assets/bf0dbd7a-8530-414d-9f65-b3c981c9ab9b)

#### 11. List all packages with a specific weight range.
![image](https://github.com/user-attachments/assets/2be1366b-9207-4cfc-9d93-481614aa82f5)


#### 12. Retrieve employees whose names contain 'John'.
![image](https://github.com/user-attachments/assets/da3f34a1-cf0e-442e-91bf-002ba518257c)

#### 13. Retrieve all courier records with payments greater than $50.

![image](https://github.com/user-attachments/assets/7c1374d1-0309-4480-88bd-48b2088fb32a)


## <p align="center"> TASK 3</p>
### GroupBy, Aggregate Functions, Having, Order By, where
14. Find the total number of couriers handled by each employee.
    ![image](https://github.com/user-attachments/assets/2555c5a8-871b-4d49-a62a-7afa3a8c013c)

15. Calculate the total revenue generated by each location
    ![image](https://github.com/user-attachments/assets/f36e1d13-d316-458e-8956-5fd4f67915e1)

16. Find the total number of couriers delivered to each location.

    ![image](https://github.com/user-attachments/assets/0d8c843d-d497-4418-9746-9c854a381138)

17. Find the courier with the highest average delivery time:
    
   ![image](https://github.com/user-attachments/assets/974bf7d9-619d-413f-9297-2f50a6c13c96)

    
18. Find Locations with Total Payments Less Than a Certain Amount

![image](https://github.com/user-attachments/assets/e839c8dd-b3d8-4057-b629-aeb6e136347e)

19. Calculate Total Payments per Location

![image](https://github.com/user-attachments/assets/ef601391-1f56-4acf-a4da-90e62f97f5db)

20. Retrieve couriers who have received payments totaling more than $1000 in a specific location
(LocationID = X):

![image](https://github.com/user-attachments/assets/cb71b1ce-4a0e-4c3f-953b-db9f79594063)


21. Retrieve couriers who have received payments totaling more than $1000 after a certain date
(PaymentDate > 'YYYY-MM-DD'):

![image](https://github.com/user-attachments/assets/3b597a78-11e7-46be-9a7e-27bc345d8473)





## <p align="center"> TASK 4</p>

23. Retrieve Payments with Courier Information 

![image](https://github.com/user-attachments/assets/9b06c060-92a3-4946-bcb3-a5edc2b3d365)

24. Retrieve Payments with Location Information

![image](https://github.com/user-attachments/assets/a60566fd-60ef-42f2-a73f-0359906afb03)

25. Retrieve Payments with Courier and Location Information

![image](https://github.com/user-attachments/assets/819123fd-43e7-4d09-9611-46cec60a821f)

26.  List all payments with courier details

   same as 23rd question

27. Total payments received for each courier

![image](https://github.com/user-attachments/assets/a6a0f96d-81bf-4002-b402-5ae054414bb5)

28. List payments made on a specific date

![image](https://github.com/user-attachments/assets/33c18db9-93f8-4f73-8497-eb25630752f0)

29. Get Courier Information for Each Payment

![image](https://github.com/user-attachments/assets/4928dec6-9d80-44d1-b712-e384d516ab97)

30. Get Payment Details with Location

![image](https://github.com/user-attachments/assets/35159888-a18b-4331-9076-c07af659a9f6)

31. Calculating Total Payments for Each Courier

![image](https://github.com/user-attachments/assets/a6a0f96d-81bf-4002-b402-5ae054414bb5)

32. List Payments Within a Date Range

![image](https://github.com/user-attachments/assets/3cb224ec-a483-4bd6-9b10-b4f34e771759)

33. Retrieve a list of all users and their corresponding courier records, including cases where there are
no matches on either side 

![image](https://github.com/user-attachments/assets/2112c2b7-8f41-4dab-ac47-88554ce55476)

34. Retrieve a list of all couriers and their corresponding services, including cases where there are no
matches on either side 

![image](https://github.com/user-attachments/assets/b187cb06-7ea8-4eb5-9246-a1f9caa68e09)

35. . Retrieve a list of all employees and their corresponding payments, including cases where there are
no matches on either side

![image](https://github.com/user-attachments/assets/803df6d3-4b2c-4a58-a3b5-1640ef5a6c83)

36. List all users and all courier services, showing all possible combinations.

![image](https://github.com/user-attachments/assets/ba2fb885-b2ff-4447-88f1-6d568549e25b)

37. . List all employees and all locations, showing all possible combinations:

![image](https://github.com/user-attachments/assets/a292c7ad-daf8-4e25-9da7-066166794261)

38. Retrieve a list of couriers and their corresponding sender information (if available)

![image](https://github.com/user-attachments/assets/d3faa57d-9cb2-4f84-8c9f-d4a09af043d1)

39. Retrieve a list of couriers and their corresponding receiver information (if available):

![image](https://github.com/user-attachments/assets/3ae8c29c-49a1-4aba-ad1a-c070e304fb08)

40. Retrieve a list of couriers along with the courier service details (if available):

![image](https://github.com/user-attachments/assets/f69c659e-39bf-43f0-8f1d-4bdc9e9ba669)

41. Retrieve a list of employees and the number of couriers assigned to each employee: 

![image](https://github.com/user-attachments/assets/3ca1f665-c4f0-4dbc-9f48-2855039749f9)

42. Retrieve a list of locations and the total payment amount received at each location:

![image](https://github.com/user-attachments/assets/2c346c9d-8ff3-484d-b05f-a4fb26f356fd)

43. Retrieve all couriers sent by the same sender (based on SenderName). 

![image](https://github.com/user-attachments/assets/72773aa7-a88a-4e9d-9634-d3d8fe4e12bb)

44.  List all employees who share the same role. 

![image](https://github.com/user-attachments/assets/29ee476d-5f79-4329-8e76-fa26656ec0ff)

45.  Retrieve all payments made for couriers sent from the same location.

![image](https://github.com/user-attachments/assets/d65fc365-f3be-4192-8cae-26808aa4d2c2)

46. Retrieve all couriers sent from the same location (based on SenderAddress). 

![image](https://github.com/user-attachments/assets/cefffc50-2060-4605-91d1-a6d788f80876)

47. List employees and the number of couriers they have delivered:

![image](https://github.com/user-attachments/assets/27b94493-6d2b-4138-8bc6-072d3e18d573)

48. Find couriers that were paid an amount greater than the cost of their respective courier services

![image](https://github.com/user-attachments/assets/b372822b-eeb5-41f3-a280-f4779225b25e)


## <p align="center"> TASK 5</p>

### Scope: Inner Queries, Non Equi Joins, Equi joins,Exist,Any,All

49. Find couriers that have a weight greater than the average weight of all couriers

![image](https://github.com/user-attachments/assets/28d286c5-d2e8-4183-9cd6-539456c4711b)

50. Find the names of all employees who have a salary greater than the average salary:

![image](https://github.com/user-attachments/assets/9e19974b-49bb-4a9f-975b-c81c715a5719)

51. Find the total cost of all courier services where the cost is less than the maximum cost

![image](https://github.com/user-attachments/assets/686a8c43-dc2c-42fe-a8b6-99f1315eb0a6)

52. Find all couriers that have been paid for

![image](https://github.com/user-attachments/assets/020dd9cf-4887-4196-a0ed-ca2ccde85fa8)

53. Find the locations where the maximum payment amount was made

![image](https://github.com/user-attachments/assets/f21aa0cf-0f7d-4be0-a6c2-3b33b462059d)


54. Find all couriers whose weight is greater than the weight of all couriers sent by a specific sender
(e.g., 'SenderName'):

![image](https://github.com/user-attachments/assets/eaf92f95-aa63-4e9d-9657-156ceec85795)

## <p align="center"> CODING</p>

## <p align="center"> TASK 1</p>

### Connecting the database 

#### Created a python file named as db_connection for connecting database

```
def get_db_connection():
    import mysql.connector

    try:
        connection = mysql.connector.connect(
            host="localhost",
            user="root",
            password="Vineeth1246@",
            database="courier_db"
        )
        return connection
    except mysql.connector.Error as err:
        print(f"Database Connection Error: {err}")
        return None

```


<p align="center">
  <img src="https://github.com/user-attachments/assets/32359cd0-6791-429d-90b7-6f403f5dfdf7" width="45%" />
</p>

### Control Flow Statements 

1. Write a program that checks whether a given order is delivered or not based on its status (e.g., "Processing," "Delivered," "Cancelled"). Use if-else statements for this.
```
def get_db_connection():
    import mysql.connector

    try:
        connection = mysql.connector.connect(
            host="localhost",
            user="root",
            password="Vineeth1246@",
            database="courier_db"
        )
        return connection
    except mysql.connector.Error as err:
        print(f"Database Connection Error: {err}")
        return None

```
### <p align="center"> output / database </p>

<p align="center">
  <img src="https://github.com/user-attachments/assets/97886216-6c97-4a82-afa5-db53b4d0fc50" width="45%" />
  <img src="https://github.com/user-attachments/assets/ffdaf511-907d-4a50-a5ce-fc1ec545da70" width="45%" />
</p>

2.   Implement a switch-case statement to categorize parcels based on their weight into "Light," "Medium," or "Heavy."

```
from db_connection import get_db_connection

def categorize_parcel(weight):
    """Categorize parcel based on weight."""
    categories = {
        "Light": lambda w: w < 2,
        "Medium": lambda w: 2 <= w < 5,
        "Heavy": lambda w: w >= 5
    }

    for category, condition in categories.items():
        if condition(weight):
            return category
    return "Unknown"

def get_parcel_weight(courier_id):
    """Fetch weight from the database based on courier_id."""
    conn = get_db_connection()
    cursor = conn.cursor()

    query = "SELECT weight FROM courier WHERE courier_id = %s"
    cursor.execute(query, (courier_id,))
    result = cursor.fetchone()

    conn.close()

    if result:
        return result[0]  # Extract weight value from result tuple
    else:
        return None

# Example usage
courier_id = int(input("Enter Courier ID: "))
weight = get_parcel_weight(courier_id)

if weight is not None:
    category = categorize_parcel(weight)
    print(f"Parcel with Courier ID {courier_id} is categorized as: {category}")
else:
    print("Courier ID not found!")

```

### <p align="center"> output / database </p>


<p align="center">
  <img src="https://github.com/user-attachments/assets/78ca4418-00e7-4bd4-a325-1735cf123f12" width="45%" />
  <img src="https://github.com/user-attachments/assets/0e2a3a31-b67a-4806-af23-21c7d427d0a6" width="45%" />
</p>


3. Implement User Authentication 1. Create a login system for employees and customers using Java
control flow statements.


```
def get_db_connection():
    import mysql.connector

    try:
        connection = mysql.connector.connect(
            host="localhost",
            user="root",
            password="Vineeth1246@",
            database="courier_db"
        )
        return connection
    except mysql.connector.Error as err:
        print(f"Database Connection Error: {err}")
        return None

# Function to authenticate employee login
def employee_login(name, password):
    conn = get_db_connection()
    cursor = conn.cursor()

    query = "SELECT * FROM employee WHERE name = %s AND password = %s"
    cursor.execute(query, (name, password))
    result = cursor.fetchone()

    cursor.close()
    conn.close()

    if result:
        print(f" Login successful! Welcome, {name}.")
    else:
        print(" Invalid credentials. Please try again.")

# Example usage
if __name__ == "__main__":
    emp_name = input("Enter your name: ")
    emp_password = input("Enter your password: ")
    employee_login(emp_name, emp_password)

```
### <p align="center"> logging in with valid credentials / invalid credentials </p>

<p align="center">
  <img src="https://github.com/user-attachments/assets/bc5f6f0c-ba4a-4cfc-8d5f-d1e5335a2e01" width="45%" />
  <img src="https://github.com/user-attachments/assets/fcacbb8b-a8da-49b2-a782-0a7eb2032853" width="45%" />
</p>

4. Implement Courier Assignment Logic 1. Develop a mechanism to assign couriers to shipments based
on predefined criteria (e.g., proximity, load capacity) using loops.

```
import mysql.connector

# Establish database connection
def get_db_connection():
    return mysql.connector.connect(
        host="localhost",
        user="root",
        password="Vineeth1246@",
        database="courier_db"
    )

# Function to assign a courier to a shipment
def assign_courier(shipment_id):
    conn = get_db_connection()
    cursor = conn.cursor()

    # Fetch shipment details (location and weight)
    cursor.execute("SELECT location_id, weight FROM shipment WHERE shipment_id = %s", (shipment_id,))
    shipment = cursor.fetchone()

    if not shipment:
        print(" Shipment not found.")
        return

    shipment_location, shipment_weight = shipment

    # Fetch a suitable courier (fixing query)
    query = """
        SELECT courier_id, weight 
        FROM courier 
        WHERE weight >= %s 
        ORDER BY weight ASC 
        LIMIT 1;
    """
    cursor.execute(query, (shipment_weight,))
    assigned_courier = cursor.fetchone()

    if assigned_courier:
        courier_id, courier_weight = assigned_courier
        print(f" Assigned Courier: {courier_id} (Max Weight: {courier_weight})")

        # Update shipment with assigned courier
        cursor.execute("UPDATE shipment SET courier_id = %s WHERE shipment_id = %s", (courier_id, shipment_id))
        conn.commit()
    else:
        print(" No suitable courier available.")

    cursor.close()
    conn.close()

# Example usage
if __name__ == "__main__":
    shipment_id = int(input("Enter Shipment ID: "))
    assign_courier(shipment_id)
```
<p align="center">
  <img src="https://github.com/user-attachments/assets/b8a70c5f-b10a-4449-905a-a92913c376e8" width="45%" />
</p>



## <p align="center"> TASK 2</p>


### <p align="center"> Loops and Iteration</p>

5. Write a python program that uses a for loop to display all the orders for a specific customer.
   
```
import mysql.connector

# Establish database connection
def get_db_connection():
    return mysql.connector.connect(
        host="localhost",
        user="root",
        password="Vineeth1246@",
        database="courier_db"
    )

# Function to display all orders for a specific customer
def display_orders(customer_id):
    conn = get_db_connection()
    cursor = conn.cursor()

    query = """
        SELECT courier_id, tracking_number, status, order_date 
        FROM courier 
        WHERE customer_id = %s
    """
    cursor.execute(query, (customer_id,))
    orders = cursor.fetchall()

    if not orders:
        print(" No orders found for this customer.")
    else:
        print(f" Orders for Customer ID {customer_id}:")
        for order in orders:
            print(f"Courier ID: {order[0]}, Tracking No: {order[1]}, Status: {order[2]}, Order Date: {order[3]}")

    cursor.close()
    conn.close()

# Example usage
if __name__ == "__main__":
    customer_id = int(input("Enter Customer ID: "))
    display_orders(customer_id)

```
### <p align="center"> output / database </p>
<p align="center">
  <img src="https://github.com/user-attachments/assets/8cddf70d-3684-4c9f-bb25-8785e0598d4c" width="45%" />
   <img src="https://github.com/user-attachments/assets/f5d40772-2f1f-4d01-b280-707b5616e99f" width="45%" />

</p>

6. Implement a while loop to track the real-time location of a courier until it reaches its destination.
```
import mysql.connector
import time


# Establish database connection
def get_db_connection():
    return mysql.connector.connect(
        host="localhost",
        user="root",
        password="Vineeth1246@",
        database="courier_db"
    )


# Function to track courier location in real-time
def track_courier(courier_id):
    conn = get_db_connection()
    cursor = conn.cursor()

    while True:
        # Fetch current location of the courier
        cursor.execute("""
            SELECT location_name FROM location 
            WHERE location_id = (SELECT location_id FROM courier WHERE courier_id = %s)
        """, (courier_id,))

        location = cursor.fetchone()

        if not location:
            print(" Courier not found.")
            break

        print(f"Current Location: {location[0]}")

        # Check if courier has reached its destination
        cursor.execute("""
            SELECT status FROM courier WHERE courier_id = %s
        """, (courier_id,))
        status = cursor.fetchone()

        if status and status[0].lower() == "delivered":
            print(" Courier has reached its destination!")
            break

        time.sleep(5)  # Simulate real-time tracking (refreshes every 5 seconds)

    cursor.close()
    conn.close()


# Example usage
if __name__ == "__main__":
    courier_id = int(input("Enter Courier ID: "))
    track_courier(courier_id)

```
<p align="center">
  <img src="https://github.com/user-attachments/assets/f13bf7fe-50da-4627-ab80-3a66e4fd7e21" width="45%" />
</p>

7. Create an array to store the tracking history of a parcel, where each entry represents a location
update.

```
import mysql.connector

# Establish database connection
def get_db_connection():
    return mysql.connector.connect(
        host="localhost",
        user="root",
        password="Vineeth1246@",
        database="courier_db"
    )

# Function to fetch tracking history
def track_courier(courier_id):
    conn = get_db_connection()
    cursor = conn.cursor()

    query = """
    SELECT t.tracking_id, c.courier_id, l.location_name, t.update_time, t.status
    FROM tracking t
    JOIN location l ON t.location_id = l.location_id
    JOIN courier c ON t.courier_id = c.courier_id
    WHERE c.courier_id = %s
    ORDER BY t.update_time ASC;
    """
    cursor.execute(query, (courier_id,))
    tracking_data = cursor.fetchall()

    if tracking_data:
        print(f" Tracking History for Courier ID {courier_id}:")
        for row in tracking_data:
            print(f"➡ {row[2]} | {row[3]} | Status: {row[4]}")
    else:
        print(" No tracking history found.")

    cursor.close()
    conn.close()

# Example usage
if __name__ == "__main__":
    courier_id = input("Enter Courier ID: ")
    track_courier(courier_id)

```

<p align="center">
  <img src="https://github.com/user-attachments/assets/432c6562-2daf-42eb-b848-bcb137043554" width="45%" />
</p>


8. Implement a method to find the nearest available courier for a new order using an array of couriers.

```
import mysql.connector


# Establish database connection
def get_db_connection():
    return mysql.connector.connect(
        host="localhost",
        user="root",
        password="Vineeth1246@",
        database="courier_db"
    )


# Function to find the nearest available courier
def find_nearest_courier(destination_location, weight):
    conn = get_db_connection()
    cursor = conn.cursor()

    # Fetch couriers who are at the nearest location and have enough capacity
    query = """
    SELECT courier_id, location_id, weight 
    FROM courier
    WHERE location_id = %s AND weight >= %s
    ORDER BY weight ASC
    LIMIT 1;
    """

    cursor.execute(query, (destination_location, weight))
    courier = cursor.fetchone()

    if courier:
        courier_id, location_id, courier_weight = courier
        print(
            f" Nearest Available Courier: ID {courier_id} at Location {location_id} with Capacity {courier_weight} kg.")
    else:
        print(" No suitable courier available.")

    cursor.close()
    conn.close()


# Example usage
if __name__ == "__main__":
    destination_location = input("Enter Destination Location ID: ")
    weight = float(input("Enter Package Weight: "))
    find_nearest_courier(destination_location, weight)

```
<p align="center">
  <img src="https://github.com/user-attachments/assets/36de4662-7501-4bb7-8744-a7c22ee31669" width="45%" />
</p>



## <p align="center"> TASK 4</p>
### <p align="center"> Strings,2d Arrays, user defined functions,Hashmap </p>


9.  _Parcel Tracking_ Create a program that allows users to input a parcel tracking number.Store the tracking number and Status in 2d String Array. Initialize the array with values. Then, simulate the tracking process by displaying messages like "Parcel in transit," "Parcel out for delivery," or "Parcel delivered" based on the tracking number's status.

```
# Initialize a 2D array with tracking numbers and statuses
parcel_tracking_data = [
    ["TRK123", "Parcel in transit"],
    ["TRK456", "Parcel out for delivery"],
    ["TRK789", "Parcel delivered"],
    ["TRK101", "Parcel in transit"],
    ["TRK202", "Parcel out for delivery"],
    ["TRK303", "Parcel delivered"]
]

# Function to track parcel status
def track_parcel(tracking_number):
    for parcel in parcel_tracking_data:
        if parcel[0] == tracking_number:
            print(f" Tracking Number: {tracking_number} - Status: {parcel[1]}")
            return
    print(" Tracking number not found.")

# Get user input
tracking_number = input("Enter Tracking Number: ").strip().upper()
track_parcel(tracking_number)

```
<p align="center">
  <img src="https://github.com/user-attachments/assets/5d98f9fd-e5ab-402e-b278-612d48e561dc" width="45%" />
</p>

10. _Customer Data Validation_: Write a function which takes 2 parameters, data-denotes the data and
detail-denotes if it is name addtress or phone number.Validate customer information based on
following critirea. Ensure that names contain only letters and are properly capitalized, addresses do not
contain special characters, and phone numbers follow a specific format (e.g., ###-###-####).

```
import re

# Function to validate customer data
def validate_customer_data(data, detail):
    if detail == "name":
        if re.fullmatch(r"[A-Za-z ]+", data):
            return f"Valid Name: {data.title()}"
        else:
            return " Invalid Name! Only letters and spaces are allowed."

    elif detail == "address":
        if re.fullmatch(r"[A-Za-z0-9 ,.-]+", data):
            return f"Valid Address: {data}"
        else:
            return " Invalid Address! Special characters are not allowed."

    elif detail == "phone":
        if re.fullmatch(r"\d{3}-\d{3}-\d{4}", data):
            return f" Valid Phone Number: {data}"
        else:
            return " Invalid Phone Number! Use format ###-###-####."

    else:
        return " Invalid detail type! Use 'name', 'address', or 'phone'."

# Get user input and validate
name = input("Enter your name: ")
print(validate_customer_data(name, "name"))

address = input("Enter your address: ")
print(validate_customer_data(address, "address"))

phone = input("Enter your phone number (###-###-####): ")
print(validate_customer_data(phone, "phone"))

```
### <p align="center"> valid  / invalid format </p>

<p align="center">
  <img src="https://github.com/user-attachments/assets/3bd2a444-2549-4588-b82a-993d560d0f69" width="45%" />
     <img src="https://github.com/user-attachments/assets/5330aa21-0f7b-4e38-a032-552f9ddd99d2" width="45%" />

</p>

11. _Address Formatting_: Develop a function that takes an address as input (street, city, state, zip code)
and formats it correctly, including capitalizing the first letter of each word and properly formatting the
zip code. 

```
import re

# Function to format address
def format_address(street, city, state, zip_code):
    if not re.fullmatch(r"\d{6}(-\d{4})?", zip_code):  # Validates ZIP (##### or #####-####)
        return " Invalid ZIP Code! Use format ##### or #####-####."

    formatted_street = street.title()  # Capitalizes first letter of each word
    formatted_city = city.title()
    formatted_state = state.upper()  # Converts state to uppercase

    return f" Formatted Address:\n{formatted_street}\n{formatted_city}, {formatted_state} {zip_code}"

# Get user input and format address
street = input("Enter Street: ")
city = input("Enter City: ")
state = input("Enter State (2-letter code): ")
zip_code = input("Enter ZIP Code (##### or #####-####): ")

print(format_address(street, city, state, zip_code))

```


### <p align="center"> valid  / invalid format </p>

<p align="center">
  <img src="https://github.com/user-attachments/assets/c85f8188-99cc-464c-9f6c-8c9ec52a3e08" width="45%" />
     <img src="https://github.com/user-attachments/assets/4814a208-b112-430c-a882-9e69160f72d6" width="45%" />

</p>


12. _Order Confirmation Email_: Create a program that generates an order confirmation email. The email
should include details such as the customer's name, order number, delivery address, and expected
delivery date. 

```
import datetime

# Function to generate order confirmation email
def generate_order_email(customer_name, order_number, address, delivery_date):
    email_template = f"""
    Subject:  Order Confirmation - #{order_number}

    Dear {customer_name},

    Thank you for your order! We are pleased to confirm your purchase.

     **Order Number:** {order_number}  
     **Delivery Address:** {address}  
     **Expected Delivery Date:** {delivery_date}  

    Your package is being prepared for shipment. You will receive tracking updates soon.

    If you have any questions, feel free to contact us.

    Regards,  
    **Courier Service Team**  
    """
    return email_template

# Get user input
customer_name = input("Enter Customer Name: ")
order_number = input("Enter Order Number: ")
address = input("Enter Delivery Address: ")

# Set expected delivery date (3 days from today)
delivery_date = (datetime.date.today() + datetime.timedelta(days=3)).strftime("%Y-%m-%d")

# Generate and display email
email_content = generate_order_email(customer_name, order_number, address, delivery_date)
print("\n" + email_content)

```


![image](https://github.com/user-attachments/assets/cee4ac26-23c7-4068-b7b9-6a7f84f74118)
![image](https://github.com/user-attachments/assets/3b6d7525-3372-4711-ae01-a2591fc76915)
![image](https://github.com/user-attachments/assets/66e89ad2-b90c-45ce-a095-aac8f9edfe18)



13. _Calculate Shipping Costs_ : Develop a function that calculates the shipping cost based on the distance
between two locations and the weight of the parcel. You can use string inputs for the source and
destination addresses.


```
# Sample distance dictionary (mock data)
distance_data = {
    ("Chennai", "Bangalore"): 350,
    ("Chennai", "Delhi"): 2200,
    ("Chennai", "Mumbai"): 1330,
    ("Bangalore", "Mumbai"): 980,
    ("Mumbai", "Delhi"): 1440,
    ("Delhi", "Kolkata"): 1530,
    ("Hyderabad", "Chennai"): 630,
}

# Shipping cost rates
BASE_COST = 50  # Base charge
COST_PER_KM = 0.5  # Cost per km
COST_PER_KG = 10  # Cost per kg


# Function to calculate shipping cost
def calculate_shipping_cost(source, destination, weight):
    # Convert input to title case to match dictionary keys
    source = source.title()
    destination = destination.title()

    # Check if distance exists in mock data
    if (source, destination) in distance_data:
        distance = distance_data[(source, destination)]
    elif (destination, source) in distance_data:  # Reverse lookup
        distance = distance_data[(destination, source)]
    else:
        print(" Shipping route not found in database.")
        return

    # Calculate cost
    shipping_cost = BASE_COST + (distance * COST_PER_KM) + (weight * COST_PER_KG)

    # Display result
    print(f" Shipping Cost from {source} to {destination}: ₹{shipping_cost:.2f}")


# Get user input
source = input("Enter Source Location: ")
destination = input("Enter Destination Location: ")
weight = float(input("Enter Parcel Weight (kg): "))

# Call function
calculate_shipping_cost(source, destination, weight)

```


<p align="center">
  <img src="https://github.com/user-attachments/assets/855ef218-40c0-4dbd-bea3-0f9de3fc99e0" width="45%" />

</p>


14. _Password Generator_: Create a function that generates secure passwords for courier system
accounts. Ensure the passwords contain a mix of uppercase letters, lowercase letters, numbers, and
special characters. 



```
import random
import string

# Function to generate a secure password
def generate_password(length=12):
    if length < 8:
        print(" Password length must be at least 8 characters.")
        return None

    # Define character sets
    upper = string.ascii_uppercase  # A-Z
    lower = string.ascii_lowercase  # a-z
    digits = string.digits  # 0-9
    special = "!@#$%^&*()-_=+"

    # Ensure at least one character from each category
    password = [
        random.choice(upper),
        random.choice(lower),
        random.choice(digits),
        random.choice(special),
    ]

    # Fill the remaining length with random choices from all sets
    all_chars = upper + lower + digits + special
    password += random.choices(all_chars, k=length - 4)

    # Shuffle the password to ensure randomness
    random.shuffle(password)

    # Convert list to string and return
    return "".join(password)

# Get user input for password length
length = int(input("Enter the desired password length (minimum 8): "))

# Generate and display the password
secure_password = generate_password(length)
if secure_password:
    print(f" Generated Secure Password: {secure_password}")

```

<p align="center">
  <img src="https://github.com/user-attachments/assets/45aba25f-74d7-4485-a8c5-b35fafe4f9e6" width="45%" />

</p>


15. _Find Similar Addresses_ : Implement a function that finds similar addresses in the system. This can be
useful for identifying duplicate customer entries or optimizing delivery routes.Use string functions to
implement this. 


```
import mysql.connector
from difflib import SequenceMatcher

# Function to establish database connection
def get_db_connection():
    return mysql.connector.connect(
        host="localhost",
        user="root",
        password="your_password",
        database="courier_db"
    )

# Function to calculate similarity between two strings
def address_similarity(addr1, addr2):
    return SequenceMatcher(None, addr1, addr2).ratio()

# Function to find similar addresses
def find_similar_addresses(threshold=0.8):
    conn = get_db_connection()
    cursor = conn.cursor()

    # Fetch all addresses from the location table
    cursor.execute("SELECT location_id, address FROM location")
    addresses = cursor.fetchall()

    similar_pairs = []
    
    # Compare each address with others
    for i in range(len(addresses)):
        for j in range(i + 1, len(addresses)):
            addr1_id, addr1 = addresses[i]
            addr2_id, addr2 = addresses[j]

            similarity = address_similarity(addr1, addr2)

            if similarity >= threshold:
                similar_pairs.append((addr1_id, addr1, addr2_id, addr2, round(similarity, 2)))

    cursor.close()
    conn.close()

    # Display results
    if similar_pairs:
        print(" Similar Addresses Found:")
        for pair in similar_pairs:
            print(f" Address {pair[0]}: {pair[1]}")
            print(f" Address {pair[2]}: {pair[3]}")
            print(f" Similarity Score: {pair[4]}\n")
    else:
        print(" No similar addresses found.")

# Run the function
find_similar_addresses()

```


<p align="center">
  <img src="https://github.com/user-attachments/assets/a7773ee8-83c6-4018-9092-c772e15d42e4" width="45%" />

</p>

## <p align="center"> TASK 5</p>
### <p align="center"> Object Oriented Programming  </p>


This module focuses on implementing object-oriented programming (OOP) concepts for a **Courier Management System**.  
It includes entity classes with proper encapsulation, constructors, getters, setters, and collections for managing couriers, employees, and locations.


### <p align="center"> project directory structure </p>

<p align="center">
  <img src="https://github.com/user-attachments/assets/34405969-ebb8-4a18-ab02-2da230bb8f4c" width="40%" />

</p>

### <p align="center"> running main script </p>

![image](https://github.com/user-attachments/assets/705ce391-cfaf-4dab-a6e4-e39e075942e0)


## <p align="center"> TASK 7</p>
### <p align="center"> Exception Handling  </p>


(Scope: User Defined Exception/Checked /Unchecked Exception/Exception handling using try..catch
finally,thow & throws keyword usage) 

Step-by-Step Implementation:
#### Create Custom Exceptions:

TrackingNumberNotFoundException to be thrown when the tracking number is not found.

InvalidEmployeeIdException to be thrown when the employee ID doesn't exist.

#### Throwing Custom Exceptions:

We will throw these exceptions in the methods based on specific conditions.

#### Handling the Exceptions:

The exceptions will be caught and handled in the main() method using try...catch blocks.

#### Step 1: Create the Exception Class (exceptions/exceptions.py)
Created a folder named exceptions/ 

Inside the exceptions/ folder, created a file named exceptions.py and place the custom exception classes in this file.

<p align="center">
  <img src="https://github.com/user-attachments/assets/4c63e18f-2599-414c-b3fe-4395e601cef9" width="20%" />

</p>


```
# exceptions/exceptions.py

class TrackingNumberNotFoundException(Exception):
    """Exception raised when tracking number is not found."""
    def __init__(self, message="Tracking number not found."):
        self.message = message
        super().__init__(self.message)


class InvalidEmployeeIdException(Exception):
    """Exception raised when the employee ID is invalid."""
    def __init__(self, message="Invalid employee ID entered."):
        self.message = message
        super().__init__(self.message)

```

#### Step 2: Create the Courier Service Logic (service/courier_service.py)
Created a folder named service/ 

Inside the service/ folder, created a file named courier_service.py.

In this file, you can define the methods for transferring and withdrawing amounts, validating employee IDs, and raising exceptions.

<p align="center">
  <img src="https://github.com/user-attachments/assets/4245ccbb-f9c7-4770-ba96-691d75e22d1c" width="20%" />
</p>


```
# service/courier_service.py
from exceptions.exceptions import TrackingNumberNotFoundException, InvalidEmployeeIdException

class CourierService:

    # Simulating a database of tracking numbers
    tracking_numbers_db = ["T1001", "T1002", "T1003"]
    
    # Simulating a database of employee IDs
    employee_ids_db = [101, 102, 103]
    
    def transfer_amount(self, tracking_number, amount):
        """Method to transfer amount; throws exception if tracking number not found."""
        if tracking_number not in self.tracking_numbers_db:
            raise TrackingNumberNotFoundException(f"Tracking number {tracking_number} does not exist!")
        else:
            print(f"Amount {amount} transferred successfully for tracking number {tracking_number}.")

    def withdraw_amount(self, tracking_number, amount):
        """Method to withdraw amount; throws exception if tracking number not found."""
        if tracking_number not in self.tracking_numbers_db:
            raise TrackingNumberNotFoundException(f"Tracking number {tracking_number} does not exist!")
        else:
            print(f"Amount {amount} withdrawn successfully for tracking number {tracking_number}.")

    def validate_employee(self, employee_id):
        """Method to validate employee ID; throws exception if ID not found."""
        if employee_id not in self.employee_ids_db:
            raise InvalidEmployeeIdException(f"Employee ID {employee_id} is invalid!")
        else:
            print(f"Employee ID {employee_id} is valid.")


```

#### Step 3: Main Program (main.py)
In the main.py file, you will import the necessary service and exception classes, and call the service methods while handling the exceptions.

```
# main.py
from service.courier_service import CourierService
from exceptions.exceptions import TrackingNumberNotFoundException, InvalidEmployeeIdException

def main():
    courier_service = CourierService()

    # Test cases to handle the exceptions

    # Handling TrackingNumberNotFoundException
    try:
        courier_service.withdraw_amount("T1005", 500)
    except TrackingNumberNotFoundException as e:
        print(f"Exception caught: {e}")
    finally:
        print("Withdraw operation attempt finished.")

    # Handling InvalidEmployeeIdException
    try:
        courier_service.validate_employee(105)
    except InvalidEmployeeIdException as e:
        print(f"Exception caught: {e}")
    finally:
        print("Employee validation attempt finished.")

    # Valid case (no exception thrown)
    try:
        courier_service.transfer_amount("T1001", 1000)
    except TrackingNumberNotFoundException as e:
        print(f"Exception caught: {e}")
    finally:
        print("Transfer operation attempt finished.")

# Execute main method
if __name__ == "__main__":
    main()

```
### <p align="center"> run main.py </p>

<p align="center">
  <img src="https://github.com/user-attachments/assets/419db5d4-1c8b-4ef8-94c3-5e7cff56bf46" width="45%" />
</p>

#### Conclusion:

exceptions/exceptions.py contains your custom exception classes.

service/courier_service.py contains the business logic for your courier operations.

main.py serves as the entry point of your application, where you handle exceptions in the main program flow.


## <p align="center"> TASK 8</p>
### <p align="center">  ArrayList/Hashmap  </p>

#### <p align="center"> Task: Improve the Courier Management System by using Java collections </p>

1. Create a new model named CourierCompanyCollection in entity package replacing the Array of
Objects with List to accommodate dynamic updates in the CourierCompany class

#### created a new model named CourierCompanyCollection in entity package

```
# entity/courier_company_collection.py

class CourierCompanyCollection:
    def __init__(self):
        # Replace the array with a list to store couriers dynamically
        self.couriers = []

    def add_courier(self, courier):
        """Add a new courier to the collection."""
        self.couriers.append(courier)

    def remove_courier(self, tracking_number):
        """Remove a courier by tracking number."""
        self.couriers = [courier for courier in self.couriers if courier.tracking_number != tracking_number]

    def get_courier(self, tracking_number):
        """Get a courier by tracking number."""
        for courier in self.couriers:
            if courier.tracking_number == tracking_number:
                return courier
        return None

    def list_all_couriers(self):
        """List all couriers in the collection."""
        return self.couriers

```
<p align="center">
  <img src="https://github.com/user-attachments/assets/2a094209-fe07-42ac-bcb2-769bfe418e77" width="25%" />
</p>

#### main.py
```
# main.py
from dao.courier_user_service_collection_impl import CourierUserServiceCollectionImpl
from entity.courier import Courier

# Create an instance of the service implementation
user_service = CourierUserServiceCollectionImpl()

# Place a new order
courier = Courier(
    sender_name="John Doe", sender_address="123 Street, NY",
    receiver_name="Alice Smith", receiver_address="456 Avenue, CA",
    weight=5.5, status="Yet to Transit", tracking_number="T1001", delivery_date=None, customer_id=1
)

tracking_number = user_service.place_order(courier)
print(f" Order placed! Tracking Number: {tracking_number}")

# Check order status
print(" Order Status:", user_service.get_order_status(tracking_number))

# Cancel an order
if user_service.cancel_order(tracking_number):
    print(" Order cancelled successfully.")
else:
    print(" Order cannot be cancelled.")

```
#### implementation:
1. Placing an Order:
When a new Courier object is created and the place_order method is called, the courier is added to the CourierCompanyCollection list, and a tracking number is generated and returned.

2. Checking the Order Status:
The get_order_status method is called with the tracking number, and it retrieves the courier's status, which will be "Yet to Transit" since that's the default status for new orders.

3. Cancelling an Order:
The cancel_order method is called with the tracking number. The courier is removed from the collection if it exists, and True is returned indicating successful cancellation. If the courier doesn't exist, False is returned.

<p align="center">
  <img src="https://github.com/user-attachments/assets/0d263942-dd2b-4553-ba39-06c9963e068b" width="25%" />
</p>

2. Create a new implementation class CourierUserServiceCollectionImpl class in package dao which
implements ICourierUserService interface which holds a variable named companyObj of type
CourierCompanyCollection

#### 1. Create the Interface (ICourierUserService)

```
# dao/icourier_user_service.py
from abc import ABC, abstractmethod

class ICourierUserService(ABC):
    
    @abstractmethod
    def place_order(self, courier):
        pass
    
    @abstractmethod
    def get_order_status(self, tracking_number):
        pass
    
    @abstractmethod
    def cancel_order(self, tracking_number):
        pass

```
<p align="center">
  <img src="https://github.com/user-attachments/assets/302e0526-3ea7-4370-be52-79fbc49ac613" width="25%" />
</p>

#### 2. Create the CourierCompanyCollection Class

This class manages a collection of Courier objects, allowing dynamic updates to the collection.

```
# entity/courier_company_collection.py

class CourierCompanyCollection:
    def __init__(self):
        self.couriers = []  # List to hold courier objects

    def add_courier(self, courier):
        """Add a new courier to the collection."""
        self.couriers.append(courier)

    def remove_courier(self, tracking_number):
        """Remove a courier by tracking number."""
        self.couriers = [courier for courier in self.couriers if courier.tracking_number != tracking_number]

    def get_courier(self, tracking_number):
        """Get a courier by tracking number."""
        for courier in self.couriers:
            if courier.tracking_number == tracking_number:
                return courier
        return None

    def list_all_couriers(self):
        """List all couriers in the collection."""
        return self.couriers

```
#### 3. Implement the CourierUserServiceCollectionImpl Class

This class will implement the ICourierUserService interface and will use CourierCompanyCollection for storing and managing courier data.

```
# dao/courier_user_service_collection_impl.py
from entity.courier_company_collection import CourierCompanyCollection
from dao.icourier_user_service import ICourierUserService
from entity.courier import Courier

class CourierUserServiceCollectionImpl(ICourierUserService):
    def __init__(self):
        self.company_obj = CourierCompanyCollection()  # Holds the collection of couriers

    def place_order(self, courier):
        """Place a new courier order and add it to the collection."""
        self.company_obj.add_courier(courier)
        return courier.tracking_number

    def get_order_status(self, tracking_number):
        """Get the status of a courier by tracking number."""
        courier = self.company_obj.get_courier(tracking_number)
        if courier:
            return courier.status
        return "Courier not found."

    def cancel_order(self, tracking_number):
        """Cancel a courier order by removing it from the collection."""
        courier = self.company_obj.get_courier(tracking_number)
        if courier:
            self.company_obj.remove_courier(tracking_number)
            return True
        return False

```
#### 4. Using the Classes in the Main Program
In your main.py, you will create an instance of CourierUserServiceCollectionImpl to interact with the collection of couriers.
```
# main.py
from dao.courier_user_service_collection_impl import CourierUserServiceCollectionImpl
from entity.courier import Courier

# Create an instance of the service implementation
user_service = CourierUserServiceCollectionImpl()

# Place a new order
courier = Courier(
    sender_name="John Doe", sender_address="123 Street, NY",
    receiver_name="Alice Smith", receiver_address="456 Avenue, CA",
    weight=5.5, status="Yet to Transit", tracking_number="T1001", delivery_date=None, customer_id=1
)

tracking_number = user_service.place_order(courier)
print(f" Order placed! Tracking Number: {tracking_number}")

# Check order status
print(" Order Status:", user_service.get_order_status(tracking_number))

# Cancel an order
if user_service.cancel_order(tracking_number):
    print(" Order cancelled successfully.")
else:
    print(" Order cannot be cancelled.")

```
#### <p align ="center"> output </p>
<p align="center">
  <img src="https://github.com/user-attachments/assets/e7a18c8f-01fd-42b9-999e-94a62fa954e1" width="45%" />
</p>


## <p align="center"> TASK 8</p>
### <p align="center">  Service implementation   </p>

1.Create _CourierUserServiceImpl_ class which implements _ICourierUserService_ interface which
holds a variable named _companyObj_ of type _CourierCompany._
This variable can be used to access the Object Arrays to access data relevant in method
implementations. 

##### we have already created   CourierCompany Class , ICourierUserService Interface , CourierUserServiceImpl Class , Courier Class for the previous tasks now modifying main class according to the given question
## Image Gallery


<table>
  <tr>
    <td style="text-align:center">
      <img src="https://github.com/user-attachments/assets/caa4decd-7c22-4590-97aa-bbac5033a0b9" alt="Image 1" width="200"/>
      <br />
      <strong>CourierCompany Class</strong>
    </td>
    <td style="text-align:center">
      <img src="https://github.com/user-attachments/assets/592872d9-c040-4a99-a5c1-3ee9bffbc236" alt="Image 2" width="200"/>
      <br />
      <strong>ICourierUserService Interface</strong>
    </td>
  </tr>
  <tr>
    <td style="text-align:center">
      <img src="https://github.com/user-attachments/assets/3e7fd074-d29b-41f5-b688-57fe2facb2b8" alt="Image 3" width="200"/>
      <br />
      <strong>CourierUserServiceImpl Class</strong>
    </td>
    <td style="text-align:center">
      <img src="https://github.com/user-attachments/assets/bfb3a9fc-0138-423c-88f9-97eb00e67c32" alt="Image 4" width="200"/>
      <br />
      <strong>Courier Class</strong>
    </td>
  </tr>
</table>

#### main.py
```
# main.py
from dao.courier_user_service_impl import CourierUserServiceImpl
from entity.courier import Courier

# Create an instance of the service implementation
user_service = CourierUserServiceImpl()

# Place a new order
courier = Courier(
    sender_name="John Doe", sender_address="123 Street, NY",
    receiver_name="Alice Smith", receiver_address="456 Avenue, CA",
    weight=5.5, status="Yet to Transit", tracking_number="T1001", delivery_date=None, customer_id=1
)

tracking_number = user_service.place_order(courier)
print(f" Order placed! Tracking Number: {tracking_number}")

# Check order status
print(" Order Status:", user_service.get_order_status(tracking_number))

# Cancel an order
if user_service.cancel_order(tracking_number):
    print(" Order cancelled successfully.")
else:
    print(" Order cannot be cancelled.")

```
![image](https://github.com/user-attachments/assets/4f5c47ce-1130-457d-94d5-24895ac08043)

## <p align="center"> TASK 9</p>
### <p align="center">  Database Interaction  </p>

#### 1. Write code to establish a connection to your SQL database. 
```

# db_connection.py
import psycopg2  # For PostgreSQL; install this library using pip if not already installed.

def get_db_connection():
    """Establish and return a database connection."""
    try:
        # Replace these values with your actual DB connection details
        connection = psycopg2.connect(
            host="localhost",
            user="root",
            password="Vineeth1246@",
            database="courier_db"
        )
        return connection
    except Exception as e:
        print(f"Error connecting to the database: {e}")
        return None

```
#### 2. Service Class for Database Operations

Create a Service class _CourierServiceDb_ in _dao_ with a static variable named _connection_ of
type Connection which can be assigned in the constructor by invoking the method in
_DBConnection_ Class.

#### Steps to Implement:

Create a new file named courier_service_db.py inside dao.

code:
```
from connectionutil.db_connection import DBConnection

class CourierServiceDb:
    # Static connection variable
    connection = None  

    def __init__(self):
        """Initialize the connection using DBConnection"""
        if CourierServiceDb.connection is None:
            CourierServiceDb.connection = DBConnection.get_connection()

    def insert_courier(self, courier):
        """Insert a new courier order into the database"""
        try:
            cursor = self.connection.cursor()
            query = """
            INSERT INTO courier (sender_name, sender_address, receiver_name, receiver_address, 
                                 weight, status, tracking_number, delivery_date, customer_id) 
            VALUES (%s, %s, %s, %s, %s, %s, %s, %s, %s)
            """
            values = (
                courier.sender_name, courier.sender_address,
                courier.receiver_name, courier.receiver_address,
                courier.weight, "Yet to Transit", courier.tracking_number,
                courier.delivery_date, courier.customer_id
            )
            cursor.execute(query, values)
            self.connection.commit()
            print(" Courier order inserted successfully!")

        except Exception as e:
            print(f" Error inserting courier: {e}")

        finally:
            cursor.close()

    def update_status(self, tracking_number, new_status):
        """Update the status of a courier"""
        try:
            cursor = self.connection.cursor()
            query = "UPDATE courier SET status = %s WHERE tracking_number = %s"
            cursor.execute(query, (new_status, tracking_number))
            self.connection.commit()
            print(f" Updated status to '{new_status}' for Tracking Number: {tracking_number}")

        except Exception as e:
            print(f" Error updating status: {e}")

        finally:
            cursor.close()

    def get_courier_by_tracking(self, tracking_number):
        """Retrieve courier details by tracking number"""
        try:
            cursor = self.connection.cursor()
            query = "SELECT * FROM courier WHERE tracking_number = %s"
            cursor.execute(query, (tracking_number,))
            result = cursor.fetchone()
            return result

        except Exception as e:
            print(f" Error fetching courier: {e}")

        finally:
            cursor.close()

```
#### Step 2: Create the DBConnection Class
already created in the last tasks

####  Step 3: Create the CourierServiceDb Class

already created in the last tasks

#### Step 4: Update main.py

```
from dao.courier_service_db import CourierServiceDb
from entity.courier import Courier

# Initialize the database service
service = CourierServiceDb()

# Create a courier order
courier = Courier(sender_name="John Doe", sender_address="123 Street, NY",
                  receiver_name="Alice Smith", receiver_address="456 Avenue, CA",
                  weight=5.5, status="Yet to Transit", tracking_number="T12345", 
                  delivery_date=None, customer_id=1)

# Insert the courier order
service.insert_courier(courier)

# Retrieve the order status
order = service.get_courier_by_tracking("T12345")
print(" Order Details:", order)

# Update order status
service.update_status("T12345", "Delivered")

# Verify update
updated_order = service.get_courier_by_tracking("T12345")
print(" Updated Order Details:", updated_order)

```


<p align="center">
  <img src="https://github.com/user-attachments/assets/502c9cfb-63a6-4614-988e-00793616cfc6" width="65%" />
</p>

#### 3. Include methods to insert, update, and retrieve data from the database (e.g., inserting a new order, updating courier status). 


##### Steps to Implement
Create a DBConnection class to establish a database connection.

Create a CourierServiceDb class with methods to:

1.   Insert a new courier order
2.   Update the courier status
3.   Retrieve courier details

#### db_connection.py (Database Connection)
```
import mysql.connector  # Use `import psycopg2` for PostgreSQL

class DBConnection:
    _connection = None

    @staticmethod
    def get_connection():
        if DBConnection._connection is None:
            try:
                DBConnection._connection = mysql.connector.connect(
                    host="localhost",
                    user="root",
                    password="your_password",
                    database="courier_db"
                )
                print(" Database connection established successfully!")
            except Exception as e:
                print(" Error connecting to the database:", e)
        return DBConnection._connection

```
#### courier_service_db.py (Service Class for Database Operations)

```
from db_connection import DBConnection

class CourierServiceDb:
    def __init__(self):
        self.connection = DBConnection.get_connection()
        self.cursor = self.connection.cursor()

    def insert_order(self, sender_name, sender_address, receiver_name, receiver_address, weight, tracking_number, customer_id):
        """Inserts a new courier order into the database."""
        query = """INSERT INTO courier (sender_name, sender_address, receiver_name, receiver_address, 
                   weight, status, tracking_number, delivery_date, customer_id) 
                   VALUES (%s, %s, %s, %s, %s, %s, %s, NULL, %s)"""
        values = (sender_name, sender_address, receiver_name, receiver_address, weight, "Yet to Transit", tracking_number, customer_id)

        try:
            self.cursor.execute(query, values)
            self.connection.commit()
            print(" Courier order inserted successfully!")
        except Exception as e:
            print(" Error inserting order:", e)

    def update_status(self, tracking_number, new_status):
        """Updates the status of an existing courier order."""
        query = "UPDATE courier SET status = %s WHERE tracking_number = %s"

        try:
            self.cursor.execute(query, (new_status, tracking_number))
            self.connection.commit()
            print(f" Updated status to '{new_status}' for Tracking Number: {tracking_number}")
        except Exception as e:
            print(" Error updating status:", e)

    def get_order_details(self, tracking_number):
        """Retrieves and displays details of a specific order."""
        query = "SELECT * FROM courier WHERE tracking_number = %s"

        try:
            self.cursor.execute(query, (tracking_number,))
            order = self.cursor.fetchone()
            if order:
                print(" Order Details:", order)
                return order
            else:
                print(" No order found with the given tracking number.")
                return None
        except Exception as e:
            print(" Error retrieving order:", e)

```

#### main.py (Testing the Methods)
```
from courier_service_db import CourierServiceDb

# Initialize the service
courier_service = CourierServiceDb()

# Insert a new order
tracking_number = "T12345"
courier_service.insert_order(
    sender_name="John Doe",
    sender_address="123 Street, NY",
    receiver_name="Alice Smith",
    receiver_address="456 Avenue, CA",
    weight=5.5,
    tracking_number=tracking_number,
    customer_id=1
)

# Retrieve and print the order details
order = courier_service.get_order_details(tracking_number)

# Update courier status to 'Delivered'
courier_service.update_status(tracking_number, "Delivered")

# Retrieve and print updated order details
courier_service.get_order_details(tracking_number)

```

<p align="center">
  <img src="https://github.com/user-attachments/assets/502c9cfb-63a6-4614-988e-00793616cfc6" width="65%" />
</p>

#### 4. Implement a feature to retrieve and display the delivery history of a specific parcel by querying the database


##### Steps to Implement Delivery History Retrieval

* To retrieve and display the delivery history of a specific parcel, follow these steps:

* Ensure  database has a delivery_history table to log status updates.

* Modify CourierServiceDb to include a method that retrieves delivery history using tracking_number.

* Call this method in main.py to display the history of a given tracking number.

##### delivery_history Table Schema

```
CREATE TABLE delivery_history (
    id INT AUTO_INCREMENT PRIMARY KEY,
    tracking_number VARCHAR(50) NOT NULL,
    status VARCHAR(50) NOT NULL,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

```

##### courier_service_db.py (Updated Service Class)

```

from db_connection import DBConnection

class CourierServiceDb:
    def __init__(self):
        self.connection = DBConnection.get_connection()
        self.cursor = self.connection.cursor()

    def insert_order(self, sender_name, sender_address, receiver_name, receiver_address, weight, tracking_number, customer_id):
        """Inserts a new courier order into the database and initializes delivery history."""
        query = """INSERT INTO courier (sender_name, sender_address, receiver_name, receiver_address, 
                   weight, status, tracking_number, delivery_date, customer_id) 
                   VALUES (%s, %s, %s, %s, %s, %s, %s, NULL, %s)"""
        values = (sender_name, sender_address, receiver_name, receiver_address, weight, "Yet to Transit", tracking_number, customer_id)

        try:
            self.cursor.execute(query, values)
            self.connection.commit()
            print(" Courier order inserted successfully!")

            # Insert initial status in delivery history
            self._insert_delivery_history(tracking_number, "Yet to Transit")
        except Exception as e:
            print(" Error inserting order:", e)

    def update_status(self, tracking_number, new_status):
        """Updates the status of an existing courier order and logs it in delivery history."""
        query = "UPDATE courier SET status = %s WHERE tracking_number = %s"

        try:
            self.cursor.execute(query, (new_status, tracking_number))
            self.connection.commit()
            print(f" Updated status to '{new_status}' for Tracking Number: {tracking_number}")

            # Log status update in delivery history
            self._insert_delivery_history(tracking_number, new_status)
        except Exception as e:
            print(" Error updating status:", e)

    def _insert_delivery_history(self, tracking_number, status):
        """Inserts a status update into the delivery history table."""
        query = "INSERT INTO delivery_history (tracking_number, status) VALUES (%s, %s)"
        try:
            self.cursor.execute(query, (tracking_number, status))
            self.connection.commit()
        except Exception as e:
            print(" Error inserting into delivery history:", e)

    def get_order_details(self, tracking_number):
        """Retrieves and displays details of a specific order."""
        query = "SELECT * FROM courier WHERE tracking_number = %s"

        try:
            self.cursor.execute(query, (tracking_number,))
            order = self.cursor.fetchone()
            if order:
                print(" Order Details:", order)
                return order
            else:
                print(" No order found with the given tracking number.")
                return None
        except Exception as e:
            print(" Error retrieving order:", e)

    def get_delivery_history(self, tracking_number):
        """Retrieves and displays the delivery history of a specific parcel."""
        query = "SELECT status, updated_at FROM delivery_history WHERE tracking_number = %s ORDER BY updated_at"

        try:
            self.cursor.execute(query, (tracking_number,))
            history = self.cursor.fetchall()
            if history:
                print(f" Delivery History for Tracking Number: {tracking_number}")
                for status, timestamp in history:
                    print(f"   {status} at {timestamp}")
            else:
                print(" No delivery history found for this tracking number.")
        except Exception as e:
            print(" Error retrieving delivery history:", e)

```
##### main.py (Test the Feature)
```
from courier_service_db import CourierServiceDb

#### Initialize the service
courier_service = CourierServiceDb()

#### Insert a new order
tracking_number = "T12345"
courier_service.insert_order(
    sender_name="John Doe",
    sender_address="123 Street, NY",
    receiver_name="Alice Smith",
    receiver_address="456 Avenue, CA",
    weight=5.5,
    tracking_number=tracking_number,
    customer_id=1
)

#### Retrieve and print the order details
courier_service.get_order_details(tracking_number)

#### Update courier status to 'In Transit'
courier_service.update_status(tracking_number, "In Transit")

#### Update courier status to 'Out for Delivery'
courier_service.update_status(tracking_number, "Out for Delivery")

#### Update courier status to 'Delivered'
courier_service.update_status(tracking_number, "Delivered")

#### Retrieve and print delivery history
courier_service.get_delivery_history(tracking_number)

```
<p align="center">
  <img src="https://github.com/user-attachments/assets/f2820eb8-6954-4900-b43b-7b8ec08579be" width="65%" />
</p>


#### 5 . Generate and display reports using data retrieved from the database
(e.g., shipment status report, revenue report). 

```
import mysql.connector

# Establish Database Connection
def get_db_connection():
    return mysql.connector.connect(
        host="your_host",
        user="your_user",
        password="your_password",
        database="your_database"
    )

# 1️ **Shipment Status Report**
def shipment_status_report():
    conn = get_db_connection()
    cursor = conn.cursor()

    query = """
    SELECT status, COUNT(*) as count
    FROM courier
    GROUP BY status
    ORDER BY count DESC
    """
    cursor.execute(query)
    results = cursor.fetchall()

    print("\n **Shipment Status Report**")
    for status, count in results:
        print(f"   {status}: {count} orders")

    cursor.close()
    conn.close()

# 2️ **Revenue Report (Assuming Rate per KG = $5)**
def revenue_report():
    conn = get_db_connection()
    cursor = conn.cursor()

    rate_per_kg = 5  # Assumed rate per kg
    query = """
    SELECT SUM(weight * %s) AS total_revenue
    FROM courier
    WHERE status = 'Delivered'
    """
    cursor.execute(query, (rate_per_kg,))
    total_revenue = cursor.fetchone()[0]

    print("\n **Revenue Report**")
    print(f"   Total Revenue from Delivered Shipments: ${total_revenue:.2f}")

    cursor.close()
    conn.close()

# Run Reports
shipment_status_report()
revenue_report()

```
<p align="center">
  <img src="https://github.com/user-attachments/assets/044ad12d-ee74-4390-8afe-c42525dfae19" width="65%" />
</p>

